{"version":3,"file":"extension.js","sources":["../../../../src/Logic/CommonLogic.ts","../../../../src/Logic/BusinessTripRegistrationLogic.ts","../../../../src/EventHandlers/BusinessTripRegistrationHandlers.ts","../../../../src/Index.ts"],"sourcesContent":["import { GenModels } from \"@docsvision/webclient/Generated/DocsVision.WebClient.Models\";\r\nimport { ILayout } from \"@docsvision/webclient/System/$Layout\";\r\nimport { $MessageBox } from \"@docsvision/webclient/System/$MessageBox\";\r\nimport { formatDateTime } from \"@docsvision/webclient/System/DateTimeUtils\";\r\n\r\nexport class CommonLogic {\r\n\r\n    public parseDate(val: unknown): Date | null {\r\n        if (val == null) return null;\r\n        if (val instanceof Date) return isNaN(val.getTime()) ? null : val;\r\n        try {\r\n            const d = new Date(val as any);\r\n            return isNaN(d.getTime()) ? null : d;\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n    \r\n    public formatDate(date: Date | null | undefined): string {\r\n        return date instanceof Date && !isNaN(date.getTime()) ? formatDateTime(date) : \"-\";\r\n    }\r\n\r\n    public formatText(val: unknown): string {\r\n        if (val == null) return \"—\";  \r\n        const s = String(val).trim();\r\n        return s.length ? s : \"—\";      \r\n    }\r\n\r\n    public isBlank(value: string): boolean {\r\n        return value.replace(/^[\\s\\u00A0]+|[\\s\\u00A0]+$/g, \"\").length === 0;\r\n    }\r\n\r\n    public hasLeadingWhitespace(value: string): boolean {\r\n        return /^[\\s\\u00A0]/.test(value);\r\n    }\r\n\r\n    public htmlToPlainText(input: unknown): string {\r\n        if (input == null) return \"\";\r\n        let s = String(input);\r\n\r\n        // Переводы строк\r\n        s = s\r\n            .replace(/<br\\s*\\/?>/gi, \"\\n\")\r\n            .replace(/<\\/p\\s*>/gi, \"\\n\");\r\n\r\n        // Удаление тегов\r\n        s = s.replace(/<[^>]+>/g, \"\");\r\n\r\n        // Декодирование\r\n        s = s\r\n            .replace(/&nbsp;/gi, \" \")\r\n            .replace(/&amp;/gi, \"&\")\r\n            .replace(/&quot;/gi, '\"')\r\n            .replace(/&#39;/gi, \"'\")\r\n            .replace(/&lt;/gi, \"<\")\r\n            .replace(/&gt;/gi, \">\");\r\n\r\n        // Нормализация пробелов/переносов\r\n        s = s.replace(/\\u00A0/g, \" \");      \r\n        s = s.replace(/\\r\\n?/g, \"\\n\");      \r\n        s = s.replace(/\\n{3,}/g, \"\\n\\n\");\r\n        return s.trim();\r\n    }\r\n}","import { ILayout } from \"@docsvision/webclient/System/$Layout\";\r\nimport { StaffDirectoryItems } from \"@docsvision/webclient/BackOffice/StaffDirectoryItems\";\r\nimport { $MessageBox } from \"@docsvision/webclient/System/$MessageBox\";\r\nimport { DateTimePicker } from \"@docsvision/webclient/Platform/DateTimePicker\";\r\nimport { TextBox } from \"@docsvision/webclient/Platform/TextBox\";\r\nimport { TextArea } from \"@docsvision/webclient/Platform/TextArea\";\r\nimport { CommonLogic } from \"./CommonLogic\";\r\nimport { DirectoryDesignerRow } from \"@docsvision/webclient/BackOffice/DirectoryDesignerRow\";\r\n\r\nexport class BusinessTripRegistrationLogic extends CommonLogic{\r\n\r\n     public async savingConfirmed(layout:ILayout): Promise<boolean> {\r\n        try {\r\n            await layout.getService($MessageBox).showConfirmation('Сохранить карточку?');\r\n            return true;\r\n        } catch(e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    public async sendSavingMsg(layout:ILayout) {\r\n        await layout.getService($MessageBox).showInfo('Карточка сохраняется!');\r\n    }\r\n    \r\n    public async sendSavedMsg(layout:ILayout) {\r\n        await layout.getService($MessageBox).showInfo('Карточка сохранена!');\r\n    }\r\n    \r\n    public async validateControlFilled(layout: ILayout): Promise<boolean> {\r\n        const controlInfo = { \r\n            controlName: \"travelingEmployee\",\r\n            fieldName: \"Командируемый\"\r\n        }; \r\n        const control = layout.controls.tryGet<StaffDirectoryItems>(controlInfo.controlName);\r\n\r\n        if (!control) {\r\n            const errorMessage = `Критическая ошибка: Контрол \"${controlInfo.controlName}\" не найден в разметке. Обратитесь к администратору системы.`;\r\n            await layout.getService($MessageBox).showError(errorMessage);\r\n            return false;\r\n        }\r\n        if (!control.params ||!control.params.value) {\r\n            await layout.getService($MessageBox).showError(`Пожалуйста, укажите сотрудника в поле \"${controlInfo.fieldName}\".`);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public async validateTextBoxFilled(layout: ILayout): Promise<boolean> {\r\n        const controlInfo = { \r\n            controlName: \"applicationNameHeader\",\r\n             fieldName: \"Название\"\r\n            }; \r\n        const control = layout.controls.tryGet<TextBox>(controlInfo.controlName);\r\n\r\n        if (!control) {\r\n            await layout.getService($MessageBox).showError(\r\n                `Критическая ошибка: контрол \"${controlInfo.controlName}\" не найден в разметке. Обратитесь к администратору системы.`\r\n            );\r\n            return false;\r\n        }\r\n\r\n        const stringRaw = control.getParamValue?.(\"value\");\r\n\r\n        if (stringRaw == null) {\r\n            await layout.getService($MessageBox).showError(`Пожалуйста, заполните поле \"${controlInfo.fieldName}\".`);\r\n            return false;\r\n        }\r\n\r\n        const value = String(stringRaw);\r\n\r\n        if (this.isBlank(value)) {\r\n            await layout.getService($MessageBox).showError(`Пожалуйста, заполните поле \"${controlInfo.fieldName}\".`);\r\n            control.params.value = null;\r\n            return false;\r\n        }\r\n\r\n        if (this.hasLeadingWhitespace(value)) {\r\n            await layout.getService($MessageBox).showError(\r\n                `В поле \"${controlInfo.fieldName}\" недопустим ведущий пробел. Удалите пробел в начале.`\r\n            );\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public async validateDateRangeOnForm(layout: ILayout): Promise<void> {\r\n        const messageBox = layout.getService($MessageBox);\r\n\r\n        const dateControls = {\r\n            tripStartDate: {\r\n                control: \"tripStartDate\",\r\n                fieldName: \"Дата с\"\r\n            },\r\n            tripEndDate: {\r\n                control: \"tripEndDate\",\r\n                fieldName: \"Дата по\"\r\n            }\r\n        };\r\n\r\n        const dateFromCtrl = layout.controls.tryGet<DateTimePicker>(dateControls.tripStartDate.control);\r\n        const dateToCtrl   = layout.controls.tryGet<DateTimePicker>(dateControls.tripEndDate.control);\r\n\r\n        if (!dateFromCtrl || !dateToCtrl) {\r\n            console.error(\"Контролы дат не найдены.\");\r\n            return;\r\n        }\r\n        \r\n        const fromRaw = dateFromCtrl.getParamValue?.(\"value\");\r\n        const toRaw   = dateToCtrl.getParamValue?.(\"value\");\r\n\r\n        const dateFrom = this.parseDate(fromRaw);\r\n        const dateTo   = this.parseDate(toRaw);\r\n\r\n        if (dateFrom == null || dateTo == null) return;\r\n\r\n        if (dateTo.getTime() <= dateFrom.getTime()) {\r\n            await messageBox.showError(\"Дата завершения командировки должна быть позднее даты ее начала.\");\r\n            dateToCtrl.params.value = null;\r\n        }\r\n    }\r\n\r\n\r\n    public async showCardSummary(layout: ILayout): Promise<void> {\r\n        const messageBox = layout.getService($MessageBox);\r\n\r\n        const APPLICATION_NAME_CTRL = \"applicationNameHeader\";   // TextBox \"Название\"\r\n        const DATE_FROM_CTRL = \"tripStartDate\";                 // DateTimePicker \"Дата с\"\r\n        const DATE_TO_CTRL = \"tripEndDate\";                    // DateTimePicker \"Дата по\"\r\n        const TRIP_BASIS_TEXT_CTRL = \"tripReasonDescription\"; // TextArea \"Основание\"\r\n        const CREATED_DATE_CTRL = \"regDate\";                 // DateTimePicker \"Дата создания\"\r\n        const TRIP_CITY_CTRL = \"destinationCity\";       // DirectoryDesignerRow \"Город назначения\"\r\n\r\n        const nameCtrl = layout.controls.tryGet<TextBox>(APPLICATION_NAME_CTRL);\r\n        const cardTitle =this.formatText(nameCtrl.getParamValue?.(\"value\"));\r\n\r\n        const createdCtrl = layout.controls.tryGet<DateTimePicker>(CREATED_DATE_CTRL);\r\n        const createdRaw = createdCtrl.getParamValue?.(\"value\");\r\n        const createdAt = this.parseDate(createdRaw);\r\n\r\n        const cityCtrl = layout.controls.tryGet<DirectoryDesignerRow>(TRIP_CITY_CTRL);\r\n        let cityText: string | null = null;\r\n\r\n        if (cityCtrl) {\r\n            const cityValue = cityCtrl.getParamValue?.(\"value\");\r\n            if (cityValue) {\r\n                cityText = cityValue.name;\r\n            }\r\n        }\r\n        cityText = this.formatText(cityText);\r\n\r\n        const fromCtrl = layout.controls.tryGet<DateTimePicker>(DATE_FROM_CTRL);\r\n        const toCtrl = layout.controls.tryGet<DateTimePicker>(DATE_TO_CTRL);\r\n\r\n        const fromRaw = fromCtrl.getParamValue?.(\"value\");\r\n        const toRaw = toCtrl.getParamValue?.(\"value\");\r\n\r\n        const fromDate = this.parseDate(fromRaw);\r\n        const toDate   = this.parseDate(toRaw);\r\n\r\n       let basis: string | null = null;\r\n\r\n       const basisTextCtrl = layout.controls.tryGet<TextArea>(TRIP_BASIS_TEXT_CTRL);\r\n       if (basisTextCtrl) {\r\n            const basisRaw = basisTextCtrl.getParamValue?.(\"value\");\r\n            const basisPlain = this.htmlToPlainText(basisRaw);\r\n            basis = this.formatText(basisPlain);\r\n        }\r\n\r\n        const lines = [\r\n            `Название карточки: ${nameCtrl ? cardTitle: \"Контрол не найден\"}`,\r\n            `Дата создания: ${createdCtrl ? this.formatDate(createdAt) : \"Контрол не найден\"}`,\r\n            `Дата с: ${fromCtrl ? this.formatDate(fromDate) : \"Контрол не найден\"}`,\r\n            `Дата по: ${toCtrl ? this.formatDate(toDate) : \"Контрол не найден\"}`,\r\n            `Город назначения: ${cityCtrl ? cityText: \"Контрол не найден\"}`,\r\n            `Основание для поездки: ${basis ?? \"Контрол не найден\"}`\r\n        ].join(\"\\n\");\r\n\r\n        await messageBox.showInfo(lines, \"Информация о командировке\");\r\n    }\r\n}","import { ILayout } from \"@docsvision/webclient/System/$Layout\";\r\nimport { CancelableEventArgs } from \"@docsvision/webclient/System/CancelableEventArgs\";\r\nimport { ICardSavingEventArgs } from \"@docsvision/webclient/System/ICardSavingEventArgs\";\r\nimport { DateTimePicker } from \"@docsvision/webclient/Platform/DateTimePicker\";\r\nimport { IDataChangedEventArgsEx } from \"@docsvision/webclient/System/IDataChangedEventArgs\";\r\nimport { BusinessTripRegistrationLogic } from \"../Logic/BusinessTripRegistrationLogic\";\r\nimport { ICancelableEventArgs } from \"@docsvision/webclient/System/ICancelableEventArgs\";\r\nimport { CustomButton } from \"@docsvision/webclient/Platform/CustomButton\";\r\nimport { Layout } from \"@docsvision/webclient/System/Layout\";\r\n\r\n/**\r\n * Событие во время сохранения карточки\r\n * @param layout разметка\r\n * @param args аргументы\r\n */\r\nexport async function ddBusinessTripRegistration_cardSaving(layout: ILayout, args: CancelableEventArgs<ICardSavingEventArgs>) {\r\n\tif (!layout) { return; }\r\n\tlet logic = new BusinessTripRegistrationLogic();\r\n\r\n    args.wait();\r\n    if (!await logic.savingConfirmed(layout)) {\r\n        args.cancel();\r\n        return;\r\n    } \r\n    \r\n    await logic.sendSavingMsg(layout);\r\n    args.accept();\r\n}\r\n\r\n\r\n/**\r\n * Событие после сохранения карточки\r\n * @param layout разметка\r\n */\r\nexport async function ddBusinessTripRegistration_cardSaved(layout: Layout) {\r\n\tif (!layout) { return; }\r\n\tlet logic = new BusinessTripRegistrationLogic();\r\n    await logic.sendSavedMsg(layout);\r\n}\r\n\r\n/**\r\n * Событие перед сохранением карточки. Проверяет заполненность поля \"Командируемый\".\r\n * @param layout Разметка карточки.\r\n * @param args Аргументы события сохранения.\r\n */\r\nexport async function ddBusinessTripRegistration_TravelingEmployeeStaffDirectoryItems_cardSaving(\r\n    layout: ILayout,\r\n    args: CancelableEventArgs<ICardSavingEventArgs>\r\n) {\r\n    if (!layout) { return; }\r\n    let logic = new BusinessTripRegistrationLogic();\r\n\r\n    args.wait();\r\n    if (!(await logic.validateControlFilled(layout))) {\r\n        args.cancel();\r\n        return;\r\n    }\r\n    args.accept()\r\n}\r\n\r\n/**\r\n * Событие перед сохранением карточки. Проверяет заполненность поля \"Название\".\r\n * @param layout Разметка карточки.\r\n * @param args Аргументы события сохранения.\r\n */\r\nexport async function ddBusinessTripRegistration_applicationNameHeaderTextBox_cardSaving(\r\n  layout: ILayout,\r\n  args: CancelableEventArgs<ICardSavingEventArgs>\r\n) {\r\n    if (!layout) { return; }\r\n    let logic = new BusinessTripRegistrationLogic();\r\n\r\n    args.wait();\r\n    if (!(await logic.validateTextBoxFilled(layout))) {\r\n        args.cancel();\r\n        return;\r\n    }\r\n    args.accept()\r\n}\r\n\r\n/**\r\n * Событие после изменения значения в контроле «Дата с»\r\n * @param sender Контрол DateTimePicker «Дата с».\r\n */\r\nexport async function ddBusinessTripRegistration_dateFrom_onDataChanged(\r\n    sender: DateTimePicker,\r\n    args: IDataChangedEventArgsEx<Date>\r\n) {\r\n    if (!sender || !sender.layout) return;\r\n    const logic = new BusinessTripRegistrationLogic();\r\n    await logic.validateDateRangeOnForm(sender.layout);\r\n}\r\n\r\n/**\r\n * Событие после изменения значения в контроле «Дата по»\r\n * @param sender Контрол DateTimePicker «Дата по».\r\n */\r\nexport async function ddBusinessTripRegistration_dateTo_onDataChanged(\r\n    sender: DateTimePicker,\r\n    args: IDataChangedEventArgsEx<Date>\r\n) {\r\n    if (!sender || !sender.layout) return;\r\n    const logic = new BusinessTripRegistrationLogic();\r\n    await logic.validateDateRangeOnForm(sender.layout);\r\n}\r\n\r\n/**\r\n * Событие по щелчку кнопки. Вывод краткой информации о документе.\r\n * @param layout Разметка карточки.\r\n */\r\nexport async function ddBusinessTripRegistration_InformCustomButton_onClick(\r\n    sender: CustomButton,\r\n    args: ICancelableEventArgs<void>\r\n) {\r\n    if (!sender || !sender.layout) return;\r\n    const logic = new BusinessTripRegistrationLogic();\r\n    await logic.showCardSummary(sender.layout);\r\n}","﻿import * as BussinessTripRegistrationHandlers from \"./EventHandlers/BusinessTripRegistrationHandlers\";\r\nimport { extensionManager } from \"@docsvision/webclient/System/ExtensionManager\";\r\n\r\n\r\n// Главная входная точка всего расширения\r\n// Данный файл должен импортировать прямо или косвенно все остальные файлы, \r\n// чтобы rollup смог собрать их все в один бандл.\r\n\r\n// Регистрация расширения позволяет корректно установить все\r\n// обработчики событий, сервисы и прочие сущности web-приложения.\r\nextensionManager.registerExtension({\r\n    name: \"DVWebExtension\",\r\n    version: \"1.0\",\r\n    globalEventHandlers: [ BussinessTripRegistrationHandlers ],\r\n    layoutServices: [ \r\n    ],\r\n    controls: [\r\n    ]\r\n})"],"names":["formatDateTime","__extends","$MessageBox","extensionManager"],"mappings":"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"}